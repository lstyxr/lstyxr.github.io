<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Python编程学习, 程序化思维提升, 总结">
<meta name="keywords" content="Python, 系统训练, Spider">
<meta property="og:type" content="website">
<meta property="og:title" content="Coding Python">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Coding Python">
<meta property="og:description" content="Python编程学习, 程序化思维提升, 总结">
<meta property="og:locale" content="zh">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Coding Python">
<meta name="twitter:description" content="Python编程学习, 程序化思维提升, 总结">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/">





  <title>Coding Python</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Coding Python</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">无尽</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/02/使用Python几行代码轻松操作多线程和多进程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/" itemprop="url">使用Python几行代码轻松操作多线程和多进程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-02T15:21:28+08:00">
                2019-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="多线程和多进程理解"><a href="#多线程和多进程理解" class="headerlink" title="多线程和多进程理解"></a>多线程和多进程理解</h1><p>线程：threading<br>进程：processing<br>1、threading 更多的是使用在频繁 I/O 的并发场景中，<br>玩过爬虫的都知道，<br>我们有时候会通过爬虫下载网页上的图片或其它文件内容，<br>这时候我们就可以使用 Python 的 threading 模块来做到多线程执行。</p>
<p>2、processing 更多的是针对要充分使用 CPU 的并行场景，<br>比如的电脑的 CPU 是六核，<br>你希望你的程序运行能充分利用到六核，<br>那么就可以使用 processing。</p>
<p>开户 1 个线程去执行 2 的 10 次方</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/1.png">

<h1 id="再来看一个爬虫例子"><a href="#再来看一个爬虫例子" class="headerlink" title="再来看一个爬虫例子"></a>再来看一个爬虫例子</h1><p>不使用多线程的情况：</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/3.png">
<p>可以看到总耗时2.9+秒完成爬取</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/4.png">

<p>再来看看开启多线程的情况</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/5.png">
<p>实现同样的功能，开启多线程只需0.8223秒就完成了<br>速度提高了 3.5+ 倍</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/6.png">

<p>再来看看开启多进程,<br>把 <strong>ThreadPoolExecutor</strong> 改成 <strong>ProcessPoolExecutor</strong> 就可以了</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/7.png">
<p>这里有个问题<br>多进程情况下，必要要用<br>if __name__ == ‘__main__:’<br>的方式才能运行多进程，否则报错<br>多线程不存在这个情况<br>这样能运行：</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/12.png"> 
<p>不加 if __name__ == ‘__main__:’ 报错：<br>提示要加 if __name__ == ‘__main__:’</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/13.png">

<h1 id="理解-submit-和-map-两种方式"><a href="#理解-submit-和-map-两种方式" class="headerlink" title="理解 submit 和 map 两种方式"></a>理解 submit 和 map 两种方式</h1><p>submit 方法:</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/8.png">
<p>map 方法:</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/9.png">
<p>它们的区别是：<br>submit方法 是传入参数从而调用具体方法<br>源码：</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/10.png">
<p>map方法 是传入可迭代对象从而调用具体方法<br>源码：</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/11.png">

<h1 id="多线程和多进程怎么选择的问题"><a href="#多线程和多进程怎么选择的问题" class="headerlink" title="多线程和多进程怎么选择的问题"></a>多线程和多进程怎么选择的问题</h1><p>CPU密集型：</p>
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/14.png">
<img src="/2019/12/02/使用Python几行代码轻松操作多线程和多进程/15.png">
<p>可以看到，多线程下执行时间并未缩短，单线程与多线程执行时间基本相同，这是由于GIL会把线程锁住，只允许一个线程执行<br>实际情况就是多线程至始至终还是单线程执行</p>
<ul>
<li>IO密集型：爬虫等频繁进行 IO 操作使用多线程较好，GIL会在IO等待时间里执行其它线程</li>
<li>CPU密集型：对于主要是计算任务的CPU密集型程序使用多进程较好</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/23/Python各种下划线的骚操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/23/Python各种下划线的骚操作/" itemprop="url">Python各种下划线的骚操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-23T14:25:26+08:00">
                2019-11-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/23/Python各种下划线的骚操作/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/23/Python各种下划线的骚操作/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我们在定义一些变量或者方法的时候，<br>常常会用到下划线，<br>在 Python 中，下划线可是很有用处的，<br>比如变量、方法中的使用，<br>有些是一个下划线开头的：_xx，<br>有些是两个下划线开头的：__xx，<br>有些是在名称的结尾添加下划线的：xx_，<br>还有一些方法我们常常看到两个下划线开头和结尾的：__xx__ 等等…</p>
<h1 id="下划线的运用种类"><a href="#下划线的运用种类" class="headerlink" title="下划线的运用种类"></a>下划线的运用种类</h1><p>“_“<br>“_xx”<br>“xx_“<br>“__xx”<br>“__xx__“<br>“_classname__xx”</p>
<h1 id="只有一个下划线“-”"><a href="#只有一个下划线“-”" class="headerlink" title="只有一个下划线“_”"></a>只有一个下划线“_”</h1><p>主要用在Python解释器中<br>_ 会指向你最后一次执行的表达式结果<br>在Python 实时交互的时候常常会用到</p>
<p>指向最后执行的表达式</p>
<img src="/2019/11/23/Python各种下划线的骚操作/1.png" title="单下划线交互">
<p>格式化变量</p>
<img src="/2019/11/23/Python各种下划线的骚操作/2.png" title="格式化变量值">
<p>这样使代码中的变量值更易读<br>使用在循环中</p>
<img src="/2019/11/23/Python各种下划线的骚操作/3.png" title="循环使用">

<h1 id="首尾分别二个下划线-xx"><a href="#首尾分别二个下划线-xx" class="headerlink" title="首尾分别二个下划线 __xx__"></a>首尾分别二个下划线 __xx__</h1><img src="/2019/11/23/Python各种下划线的骚操作/4.png">
<p>这些我们叫它们为“魔法函数”<br>是Python 内置好了的，直接拿来用就行了<br>应尽量避免以这种方式命名变量</p>
<h1 id="单个下划线开头的-xx"><a href="#单个下划线开头的-xx" class="headerlink" title="单个下划线开头的 _xx"></a>单个下划线开头的 _xx</h1><p>以单个下划线开关命名的方法或者变量<br>就是说明它是仅提供内部使用的<br>举例说明<br>先定义好一个模块 test1.py<br>其中有两个方法，一个是单划线开头，一个不是</p>
<img src="/2019/11/23/Python各种下划线的骚操作/5.png">
<p>接着在第二个模块 test2 中 import test1<br>调用 test1 中的方法看看<br>当执行 my_func() 时成功</p>
<img src="/2019/11/23/Python各种下划线的骚操作/6.png">
<img src="/2019/11/23/Python各种下划线的骚操作/7.png">

<p>但是执行 _my_func() 时报错<br>“_my_func” 没有定义，<br>因此它只能在模块内部使用</p>
<img src="/2019/11/23/Python各种下划线的骚操作/8.png">
<img src="/2019/11/23/Python各种下划线的骚操作/10.png">

<p>这里有个问题是，直接 import test1<br>test1._my_func() 也是成功的<br>把 test1 模块名写在前面相当于显式内部调用吧</p>
<img src="/2019/11/23/Python各种下划线的骚操作/9.png">
<img src="/2019/11/23/Python各种下划线的骚操作/11.png">

<h1 id="单个下划线结尾的-xx"><a href="#单个下划线结尾的-xx" class="headerlink" title="单个下划线结尾的 xx_"></a>单个下划线结尾的 xx_</h1><p>Python 中的许多关键字<br>def、return、class、pass、True、False等等<br>是不能用来命名的</p>
<img src="/2019/11/23/Python各种下划线的骚操作/12.png">

<p>如果非要使用这些系统关键词<br>就可以在尾部加 _</p>
<img src="/2019/11/23/Python各种下划线的骚操作/13.png">
<p>但不建议这么做，还是选用其它的名称命名吧</p>
<h1 id="两个下划线开头的命名：-xx"><a href="#两个下划线开头的命名：-xx" class="headerlink" title="两个下划线开头的命名：__xx"></a>两个下划线开头的命名：__xx</h1><p>这种命名方式更多的是用在类的继承<br>通过两个下划线开头命名的成员<br>可以<strong>防止被子类重写</strong></p>
<img src="/2019/11/23/Python各种下划线的骚操作/14.png">
<img src="/2019/11/23/Python各种下划线的骚操作/15.png">

<p>这里可以看出<br>name 可以访问<br>但是 __age 无法访问的<br>所以就无法重写父类的 __age</p>
<p>打印对象的属性：</p>
<img src="/2019/11/23/Python各种下划线的骚操作/16.png">
<p>从输出的属性中可以看到<br>name 还是 name<br>但 __age 变成了 _Person__age</p>
<p>来来个继承看看</p>
<img src="/2019/11/23/Python各种下划线的骚操作/17.png">
<p>可以看到，name 被子类重写了，而 __age 不能访问，也没有被重写<br>同时，打印一下 Son 的属性看看</p>
<img src="/2019/11/23/Python各种下划线的骚操作/18.png">
<p>这里 son 类里面定义的 __age 已经变成了 _Son__age<br>所以要访问或重写只能这样显式调用</p>
<img src="/2019/11/23/Python各种下划线的骚操作/19.png">
<p>可以成功访问父类和子类的__age 属性</p>
<h1 id="一个下划线-类名-二个下划线开头的命名：-classname-xx"><a href="#一个下划线-类名-二个下划线开头的命名：-classname-xx" class="headerlink" title="一个下划线+类名+二个下划线开头的命名：_classname__xx"></a>一个下划线+类名+二个下划线开头的命名：_classname__xx</h1><p>可以像这样指定类名的方式命名</p>
<img src="/2019/11/23/Python各种下划线的骚操作/20.png">

<p>Python 并没有向别的编程语言那样有 private 来修饰属性进行私有化，<br>所以可以通过 __ 的方式进行 “伪私有化”，<br>不过还是可以通过实例访问得到相应的值</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/22/使用enumerate来枚举可遍历对象/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/22/使用enumerate来枚举可遍历对象/" itemprop="url">使用enumerate来枚举可遍历对象</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-22T18:49:30+08:00">
                2019-11-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/22/使用enumerate来枚举可遍历对象/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/22/使用enumerate来枚举可遍历对象/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="初识枚举函数-enumerate"><a href="#初识枚举函数-enumerate" class="headerlink" title="初识枚举函数 enumerate()"></a>初识枚举函数 enumerate()</h1><p>今天我们来认识一下 Python 的 enumerate 这个内置的函数，<br>它就是专门用来枚举可迭代对象的，<br>通过它我们可以在每次迭代的过程中，<br>获取到具体的索引、数据和下标。</p>
<p>enumerate 函数语法</p>
<blockquote>
<p>enumerate(iterable[, start])</p>
</blockquote>
<p>要得到一个 enumerate对象很简单<br>直接调用 enumerate 方法，把可迭代对象传入就可以了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&apos;hi&apos;, &apos;fxxk&apos;, &apos;Python&apos;, &apos;handsomeb&apos;]</span><br><span class="line">print(enumerate(list1))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&lt;enumerate object at 0x02E33850&gt;</p>
</blockquote>
<p>当我们执行了 enumerate 方法之后，<br>它会直接把我们传递进去的可迭代对象<br>生成含有索引和对应的值的 enumerate 对象，<br>所以这个对象是可以使用 for 循环的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&apos;hi&apos;, &apos;fxxk&apos;, &apos;Python&apos;, &apos;handsomeb&apos;]</span><br><span class="line"></span><br><span class="line">for item in enumerate(list1):</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>(0, ‘hi’)<br>(1, ‘fxxk’)<br>(2, ‘Python’)<br>(3, ‘handsomeb’)</p>
</blockquote>
<p>enumerate 函数可以传两个参数，<br>一个就是我们刚说的可迭代对象，<br>另一个就是数字，<br>这个数字的作用就是让 enumerate 从指定位置（默认为0）开始计数，<br>也就是说，如果我们希望 enumerate 对我们传进去的可迭代对象从第 5 开始生成，<br>那么就可以这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&apos;hi&apos;, &apos;fxxk&apos;, &apos;Python&apos;, &apos;handsomeb&apos;]</span><br><span class="line"></span><br><span class="line">for item in enumerate(list1, 5):</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>(5, ‘hi’)<br>(6, ‘fxxk’)<br>(7, ‘Python’)<br>(8, ‘handsomeb’)</p>
</blockquote>
<p>在枚举的时候<br>也可以将得到的 enumerate 对象的计数单独拿到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&apos;hi&apos;, &apos;fxxk&apos;, &apos;Python&apos;, &apos;handsomeb&apos;]</span><br><span class="line"></span><br><span class="line">for count, value in enumerate(list1):</span><br><span class="line">    print(count)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0<br>1<br>2<br>3</p>
</blockquote>
<p>当然，也可将得到的 enumerate 对象转换成列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&apos;hi&apos;, &apos;fxxk&apos;, &apos;Python&apos;, &apos;handsomeb&apos;]</span><br><span class="line"></span><br><span class="line">list2 = list(enumerate(list1))</span><br><span class="line">print(list2)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[(0, ‘hi’), (1, ‘fxxk’), (2, ‘Python’), (3, ‘handsomeb’)]</p>
</blockquote>
<p>那些需要我们做一些计数相关的<br>或者需要将数字与元素做一些对应关系的时候<br>就可以使用 enumerate 进行枚举获取，<br>其内部主要是帮我们做了这样的操作：<br>enumerate 函数内部实现大概原理如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def enumerate(sequence, start=0):</span><br><span class="line">    n = start</span><br><span class="line">    for elem in sequence:</span><br><span class="line">        yield n, elem</span><br><span class="line">        n += 1</span><br></pre></td></tr></table></figure>

<h1 id="简单应用举例"><a href="#简单应用举例" class="headerlink" title="简单应用举例"></a>简单应用举例</h1><p>将月份的英语单词与数字月进行对应</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">month = [</span><br><span class="line">    &apos;January&apos;,</span><br><span class="line">    &apos;February&apos;,</span><br><span class="line">    &apos;March&apos;,</span><br><span class="line">    &apos;April&apos;,</span><br><span class="line">    &apos;May&apos;,</span><br><span class="line">    &apos;June&apos;,</span><br><span class="line">    &apos;July&apos;,</span><br><span class="line">    &apos;August&apos;,</span><br><span class="line">    &apos;September&apos;,</span><br><span class="line">    &apos;October&apos;,</span><br><span class="line">    &apos;November&apos;,</span><br><span class="line">    &apos;December&apos;]</span><br><span class="line"></span><br><span class="line">for num, value in enumerate(month, 1):</span><br><span class="line">    print(f&apos;&#123;num&#125;月 -》&#123;value&#125;&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>1月 -》January<br>2月 -》February<br>3月 -》March<br>4月 -》April<br>5月 -》May<br>6月 -》June<br>7月 -》July<br>8月 -》August<br>9月 -》September<br>10月 -》October<br>11月 -》November<br>12月 -》December</p>
</blockquote>
<p>以上就是 enumerate 对象的使用方式。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/21/什么是Python的可迭代对象迭代器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/21/什么是Python的可迭代对象迭代器/" itemprop="url">什么是Python的可迭代对象迭代器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-21T11:13:31+08:00">
                2019-11-21
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/21/什么是Python的可迭代对象迭代器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/21/什么是Python的可迭代对象迭代器/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="理解可迭代对象"><a href="#理解可迭代对象" class="headerlink" title="理解可迭代对象"></a>理解可迭代对象</h1><p>容器: 列表、字典、元组、集合等<br>都是将数据封装起来也供使用，只是它们各自的“安排方式”不同</p>
<p>容器可以被循环</p>
<p>for item in 容器:</p>
<p>这些可以被 for 循环的容器（对象）<br>我们就说它是可迭代的，<br>也就是<strong>可迭代对象，是 Iterable 的</strong></p>
<p>isinstance() 函数来判断一个对象是否是一个已知的类型<br>可以通过 isinstance 来判断这个对象是否可迭代（Iterable）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from collections import Iterable</span><br><span class="line"></span><br><span class="line">print(&apos;列表&apos;, isinstance([], Iterable))</span><br><span class="line">print(&apos;字典&apos;, isinstance(&#123;&#125;, Iterable))</span><br><span class="line">print(&apos;元组&apos;, isinstance((), Iterable))</span><br><span class="line">print(&apos;字符串&apos;, isinstance(&apos;&apos;, Iterable))</span><br><span class="line">print(&apos;整数&apos;, isinstance(66, Iterable))</span><br><span class="line">print(&apos;生成器&apos;, isinstance((i for i in range(10)), Iterable))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>列表 True<br>字典 True<br>元组 True<br>字符串 True<br>整数 False<br>生成器 True</p>
</blockquote>
<p>可以看到，除了整型对象外，其余对象、<strong>生成器</strong>均是可迭代对象</p>
<p>这些可迭代对象（Iterable）可以生成迭代器（Iterator）</p>
<h1 id="迭代器的特点"><a href="#迭代器的特点" class="headerlink" title="迭代器的特点"></a>迭代器的特点</h1><p>当我们去使用迭代器的时候，<br>我们不用关心这个对象的长度，<br>不用关心容器里面是如何安排数据的。</p>
<p>迭代器之所以可迭代，<br>是因为它们提供了一个 next() 方法，<br>通过这个方法我们可以不断的去获取容器里面的下一个元素，<br>直到这个容器没有数据然后报 StopIteration 为止：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list1 = [11, 22, 33, 44, 212]</span><br><span class="line">print(next(list1))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>TypeError: ‘list’ object is not an iterator</p>
</blockquote>
<p>这里列表是可迭代对象(Iterable)，但还不是迭代器，因此不能使用 next() 方法<br>将列表转为迭代器（Iterator）要使用<strong>iter</strong> 魔法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">list1 = [11, 22, 33, 44, 212].__iter__()</span><br><span class="line">print(next(list1))</span><br><span class="line">print(next(list1))</span><br><span class="line">print(next(list1))</span><br><span class="line">print(next(list1))</span><br><span class="line">print(next(list1))</span><br><span class="line">print(next(list1))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>22<br>33<br>44<br>212<br>StopIteration</p>
</blockquote>
<p>可以看到，我们这里调用 iter 魔法方法，<br>成功将列表（可迭代对象）变为 迭代器（Iterator）, 从而使用 next 方法</p>
<p>可以通过 isinstance 来判断这个对象是否是迭代器（Iterator）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from collections import Iterator</span><br><span class="line">print(&apos;列表&apos;, isinstance(iter([]), Iterator))</span><br><span class="line">print(&apos;字典&apos;, isinstance(iter(&#123;&#125;), Iterator))</span><br><span class="line">print(&apos;元组&apos;, isinstance(iter(()), Iterator))</span><br><span class="line">print(&apos;字符串&apos;, isinstance(iter(&apos;&apos;), Iterator))</span><br><span class="line">print(&apos;整数&apos;, isinstance(66, Iterator))</span><br><span class="line">print(&apos;生成器&apos;, isinstance((i for i in range(10)), Iterator))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>列表 True<br>字典 True<br>元组 True<br>字符串 True<br>整数 False<br>生成器 True</p>
</blockquote>
<p>从以上输出结果可以看出<br>生成器本身也是迭代器（iterator）<br>所以不用 iter 魔法转换，<br>生成器继可以用 next 不断迭代，也可以使用 for 循环。</p>
<p>只有可迭代对象才能用 iter 魔法转换为 迭代器（iterator）<br>所以下列代码中 iter(66)报措</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;整数&apos;, isinstance(iter(66), Iterator))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>TypeError: ‘int’ object is not iterable</p>
</blockquote>
<p><strong>总结</strong><br>到这里你应该明白这么几点：</p>
<p>1、迭代和我们一般所认为的遍历枚举的差别在于：<br>迭代是不需要知道容器的“容量”的，<br>每次访问都可以获取到下一个元素，直到没有为止。<br>就好像你去 Apple 官网买 iPhone 一样，<br>你不需要他们罗列出了多少台手机，<br>你可以一直买，<br>每次他都给你发手机，<br>直到没货了，<br>他才会跟你说不好意思，库存不足。（StopIteration）停止迭代</p>
<p>2、可迭代对象不可以使用 next() 方法，迭代器才可以，<br>如何成为迭代器呢？使用 iter 方法。</p>
<p>3、迭代器是在每次获取才去计算下一个元素的，<br>所以它降低不必要的内存浪费，也可以存储一些 “理想” 的数据，<br>比如可以存储根据一定规律的无穷个数字：“2,4,6,8,10…….10000000000000(无穷)”，<br>但是用一般的列表来存储的话，根本不可能，内存早就爆炸了。</p>
<p>4、 for i in 迭代器的过程中，实际上就是再不断的调用 next()：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">list1 = iter(range(10))</span><br><span class="line">print(list1)</span><br><span class="line"></span><br><span class="line">for item in list1:</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&lt;range_iterator object at 0x0293DCF8&gt;<br>0<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9</p>
</blockquote>
<p>等价于：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list1 = iter(range(10))</span><br><span class="line">print(list1)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    try:</span><br><span class="line">        print(next(list1))</span><br><span class="line">    except StopIteration:  # 没有数据了</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&lt;range_iterator object at 0x0263DCF8&gt;<br>0<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9</p>
</blockquote>
<p>5、生成器是一个迭代器。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/19/yield是什么魔鬼生成器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/19/yield是什么魔鬼生成器/" itemprop="url">yield是什么魔鬼生成器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-19T11:39:55+08:00">
                2019-11-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/19/yield是什么魔鬼生成器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/19/yield是什么魔鬼生成器/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="生成器的理解"><a href="#生成器的理解" class="headerlink" title="生成器的理解"></a>生成器的理解</h1><p>生成器与列表相关<br>我们知道一行代码就可以生成一个列表 [x for x in range(num)]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my_list = [[x, x % 2] for x in range(10)]</span><br><span class="line">print(my_list)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[[0, 0], [1, 1], [2, 0], [3, 1], [4, 0], [5, 1]]</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my_list = ([x, x % 2] for x in range(6))</span><br><span class="line">print(my_list)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&lt;generator object <genexpr> at 0x069B8970&gt;</genexpr></p>
</blockquote>
<p>第二个代码输出了一个 generator（生成器） 对象<br>区别是：<br>第一个代码用的[]<br>第二个代码用的()<br>这就是生成器，不直接输出列表<br>可以通过 next() 方法调用这个生成器里的元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">print(next(my_list))</span><br><span class="line">print(next(my_list))</span><br><span class="line">print(next(my_list))</span><br><span class="line">print(next(my_list))</span><br><span class="line">print(next(my_list))</span><br><span class="line">print(next(my_list))</span><br><span class="line">print(next(my_list))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[0, 0]<br>[1, 1]<br>[2, 0]<br>[3, 1]<br>[4, 0]<br>[5, 1]</p>
</blockquote>
<p>这有什么区别呢？<br>现在把运算加大，<br>考虑这两行代码的运行时间，谁长谁短呢？<br>来个装饰器计时，看看两者的区别</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my_list1 = [[x, x % 2] for x in range(6666666)]</span><br><span class="line">my_list2 = ([x, x % 2] for x in range(6666666))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">def log_func_time(func):</span><br><span class="line">    def wrapper():</span><br><span class="line">        start_time = time.perf_counter()</span><br><span class="line">        result = func()</span><br><span class="line">        end_time = time.perf_counter()</span><br><span class="line">        print(&apos;方法 &#123;&#125; , 消耗了 &#123;&#125; ms&apos;.format(func.__name__, (end_time - start_time) * 1000))</span><br><span class="line">        return result</span><br><span class="line"></span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line">@log_func_time</span><br><span class="line">def calculate_func_1():</span><br><span class="line">    my_list1 = [[x, x % 2] for x in range(6666666)]</span><br><span class="line"></span><br><span class="line">@log_func_time</span><br><span class="line">def calculate_func_2():</span><br><span class="line">    my_list2 = ([x, x % 2] for x in range(6666666))</span><br><span class="line"></span><br><span class="line">calculate_func_1()</span><br><span class="line">calculate_func_2()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>方法 calculate_func_1 , 消耗了 3356.3896 ms<br>方法 calculate_func_2 , 消耗了 0.0181000000001319 ms</p>
</blockquote>
<p>从返回结果看出，方法二，也就是生成器所消耗的时间远小于方法一<br>这是因为<br>方法一：直接生成了 6666666 个元素并封闭进列表，耗时并占用大量内存<br>方法二：只记录了设定的算法规则，这里的 for x in range(6666666) 就是不断 +1 的规则<br>生成器只需记住这个规则，不需要一次性地将列表封装，<br>等在需要的时候，再按规则运算一下，然后将结果返回<br>几乎不占内存</p>
<p>总结，这就是生成器<br><strong>它是根据一定的规律算法生成的，</strong><br><strong>当我们去遍历它的时候，</strong><br><strong>它可以通过特定的算法不断的推算出相应的元素，</strong><br><strong>边运行边推算结果，从而节省了很多空间。</strong></p>
<p>继续体会这两者的区别<br>方法1将结果直接存入列表，for 循环只是将现存列表简单遍历打印出来<br>方法2是需要的时候才运算提取，每次 for 循环调用一次规则：([x, x % 2] for x in range(15))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@log_func_time</span><br><span class="line">def calculate_func_1():</span><br><span class="line">    my_list1 = [[x, x % 2] for x in range(15)]</span><br><span class="line">    for item in my_list1:</span><br><span class="line">        print(item)</span><br><span class="line"></span><br><span class="line">@log_func_time</span><br><span class="line">def calculate_func_2():</span><br><span class="line">    my_list2 = ([x, x % 2] for x in range(15))</span><br><span class="line">    for item in my_list2:</span><br><span class="line">        print(item)</span><br></pre></td></tr></table></figure>

<h1 id="魔法关键词-yield"><a href="#魔法关键词-yield" class="headerlink" title="魔法关键词 yield"></a>魔法关键词 yield</h1><p>yield 与 return 关键词都是运用于函数中返回值<br>return 在函数中执行这个关键词就会返回相应的结果终止函数的运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def foo():</span><br><span class="line">    a = 1</span><br><span class="line">    b = 2</span><br><span class="line">    return a + b</span><br><span class="line">    print(&quot;ooxx-ooxx-oooooxxxxx.....&quot;)</span><br><span class="line"></span><br><span class="line">print(foo())</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3</p>
</blockquote>
<p>函数遇到 return 关键字就返回，而后的语句不再被执行到</p>
<p>再来看 yield 关键字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def foo():</span><br><span class="line">    print(&apos;1111&apos;)</span><br><span class="line">    yield</span><br><span class="line">    print(&apos;2222&apos;)</span><br><span class="line">    yield</span><br><span class="line">    print(&apos;3333&apos;)</span><br><span class="line">    yield</span><br><span class="line">    print(&apos;4444&apos;)</span><br><span class="line">    yield</span><br><span class="line"></span><br><span class="line">f = foo()</span><br><span class="line">print(type(f))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&lt;class ‘generator’&gt;</p>
</blockquote>
<p>直接调用生成器函数没有返回结果<br>打印出对象类型为 generator（生成器）</p>
<p><strong>一个函数里定义了 yield 关键字，那么这个函数就是一个生成器</strong></p>
<p>可以用 next 方法使用生成器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">next(f)</span><br><span class="line">next(f)</span><br><span class="line">next(f)</span><br><span class="line">next(f)</span><br><span class="line">next(f)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>1111<br>2222<br>3333<br>4444<br>StopIteration<br>前四个 next 依次返回打印<br>第五个 next 没有数据了，返回 StopIteration</p>
</blockquote>
<p>再遍历一下看看：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for item in f:</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>1111<br>None<br>2222<br>None<br>3333<br>None<br>4444<br>None</p>
</blockquote>
<p>返回了 None, 这是因为 yield 行并没有具体返回结果</p>
<p>再来看 yield 后加上返回内容的情形：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def foo():</span><br><span class="line">    yield &apos;第1次 yield&apos;</span><br><span class="line">    yield &apos;第2次 yield&apos;</span><br><span class="line">    yield &apos;第3次 yield&apos;</span><br><span class="line">    yield &apos;第4次 yield&apos;</span><br><span class="line"></span><br><span class="line">f = foo()</span><br><span class="line"></span><br><span class="line">for item in f:</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>第1次 yield<br>第2次 yield<br>第3次 yield<br>第4次 yield</p>
</blockquote>
<p>以上仅仅展示简单的示例，也求快速理解 yield<br><strong>生成器是按一定的规律算法生成的列表</strong><br>当我们去遍历它的时候，它可以通过特定的算法不断的推算出相应的元素，<br>边运行边推算结果，从而节省了很多空间。</p>
<p>所以 yield 一般是用在 for 循环中以一定规则生成<br>简单运用举例：输出18以内的偶数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def foo():</span><br><span class="line">    for num in range(10):</span><br><span class="line">        yield num * 2</span><br><span class="line"></span><br><span class="line">for item in foo():</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0<br>2<br>4<br>6<br>8<br>10<br>12<br>14<br>16<br>18</p>
</blockquote>
<p>另外，yield 后面可以跟常用的数据类型，<br>比如：string、int、dict 等<br>比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yield &#123;</span><br><span class="line">        &apos;text&apos;: text,</span><br><span class="line">        &apos;class_attrib&apos;: format_html(&apos; class=&quot;column-&#123;&#125;&apos;, field_name),</span><br><span class="line">        &apos;sortable&apos;: False</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>再比如 Scrapy 爬虫框架中经常要 yield item</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for img in response.xpath(&apos;//img[@referrerpolicy]&apos;):</span><br><span class="line">            item[&apos;alt&apos;] = img.xpath(&apos;./@alt&apos;).extract()</span><br><span class="line">            item[&apos;data_original&apos;] = img.xpath(&apos;./@data-original&apos;).extract()</span><br><span class="line">            yield item</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/18/如何一行代码就快速生成列表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/18/如何一行代码就快速生成列表/" itemprop="url">如何一行代码就快速生成列表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-18T15:47:25+08:00">
                2019-11-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/18/如何一行代码就快速生成列表/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/18/如何一行代码就快速生成列表/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>牛逼的一行代码生成列表<br>将数据封装到列表，常用的方法多半如此：<br>需要多行代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">my_list = []</span><br><span class="line">my_list2 = []</span><br><span class="line"></span><br><span class="line">for i in range(1, 15):</span><br><span class="line">    if i % 2 == 0:</span><br><span class="line">        my_list.append(i)</span><br><span class="line"></span><br><span class="line">for item in my_list:</span><br><span class="line">    item = item * 2</span><br><span class="line">    my_list2.append(item)</span><br><span class="line"></span><br><span class="line">print(my_list)</span><br><span class="line">print(my_list2)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[2, 4, 6, 8, 10, 12, 14]<br>[4, 8, 12, 16, 20, 24, 28]</p>
</blockquote>
<p>人生苦短<br><strong>对于一些通过循环和特定条件生成的列表</strong><br><strong>更好的解决方法是用一行代码制定它们</strong><br>一行代码搞定15以内偶数封装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my_list = [i for i in range(1, 15) if i % 2 == 0]</span><br><span class="line">print(my_list)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[2, 4, 6, 8, 10, 12, 14]</p>
</blockquote>
<p>一行代码将15以内的偶数 * 2，封装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my_list2 = [i * 2 for i in range(1, 15) if i % 2 == 0]</span><br><span class="line">print(my_list2)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[4, 8, 12, 16, 20, 24, 28]</p>
</blockquote>
<p>总结：<br>基本形式：<br><strong>new_list = [表达式 循环语句 条件]</strong><br>解释意思：<br><strong>位置1放：表达式</strong><br><strong>位置2放：循环语句</strong><br><strong>位置3放：判断条件</strong><br>就这么简单粗暴</p>
<p>这里的 表达式 不仅仅可以做加减乘除，也可以放一些方法调用，<br>例如将列表中的单词全部转换为小写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my_list3 = [&apos;WHAT&apos;, &apos;THE&apos;, &apos;FUCK&apos;, &apos;PYTHON&apos;, &apos;HANDSOMEB&apos;, &apos;NICE&apos;]</span><br><span class="line">new_list = [s.lower() for s in my_list3]</span><br><span class="line">print(new_list)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[‘what’, ‘the’, ‘fuck’, ‘python’, ‘handsomeb’, ‘nice’]</p>
</blockquote>
<p>生成多个元组，再将多个元组放入列表中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my_list4 = [2, 3, 4, 5, 6, 7, 8, 9, 0]</span><br><span class="line">new_my_list4 = [(i, i**2) for i in my_list4]</span><br><span class="line">print(new_my_list4)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[(2, 4), (3, 9), (4, 16), (5, 25), (6, 36), (7, 49), (8, 64), (9, 81), (0, 0)]</p>
</blockquote>
<p>再来看一个 for 循环的嵌套例子<br>将两个列表中相同的元素放入新列表<br>传统方法这样写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">my_list = [1, 2, 4, 5, 6, 7, 8, 9]</span><br><span class="line">my_list2 = [9, 2, 3, 4, 8]</span><br><span class="line">new_list = []</span><br><span class="line"></span><br><span class="line">for i in my_list:</span><br><span class="line">    for j in my_list2:</span><br><span class="line">        if i == j:</span><br><span class="line">            new_list.append(i)</span><br><span class="line"></span><br><span class="line">print(new_list)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[2, 4, 8, 9]</p>
</blockquote>
<p>改为一行代码搞定：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">new_list = [i for i in my_list for j in my_list2 if i == j]</span><br><span class="line">print(new_list)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[2, 4, 8, 9]</p>
</blockquote>
<p><strong>new_list = [表达式 循环语句 条件]</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/14/python中的函数高级用法装饰器语法糖/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/14/python中的函数高级用法装饰器语法糖/" itemprop="url">python中的函数高级用法装饰器语法糖</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-14T16:33:54+08:00">
                2019-11-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/14/python中的函数高级用法装饰器语法糖/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/14/python中的函数高级用法装饰器语法糖/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>函数可以被当做参数进行调用</p>
<h1 id="装饰器的两种写法"><a href="#装饰器的两种写法" class="headerlink" title="装饰器的两种写法"></a>装饰器的两种写法</h1><h2 id="第一种：方便理解"><a href="#第一种：方便理解" class="headerlink" title="第一种：方便理解"></a>第一种：方便理解</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def func_1(func):</span><br><span class="line">    def func_2():</span><br><span class="line">        print(&apos;func_2&apos;)</span><br><span class="line">        func()</span><br><span class="line">    return func_2</span><br><span class="line"></span><br><span class="line">def say():</span><br><span class="line">    print(&apos;fxxk python&apos;)</span><br><span class="line"></span><br><span class="line">f = func_1(say)</span><br><span class="line">f()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>func_2<br>fxxk python</p>
</blockquote>
<p>1、一开始通过执行 f = func_1(say)，也就是说，把 say 这个方法传递给 func_1 函数；</p>
<p>2、那么这时候就会执行第二行，遇到了 func_2 函数然后 return 回来；</p>
<p>3、f 指向了这个 func_1 ;</p>
<p>4、接着执行 f() , 这时候就会执行第三行打印 fuc_2；</p>
<p>5、接着会向下执行 func(), 进入第 8 行打印 fxxk python。</p>
<p>你仔细看这个 func_1 函数，它的参数是接收一个函数，然后在内部使用它，最后返回的是另一个函数。</p>
<p>也就是说，一个函数，把另一个函数作为参数传进来，然后在内部去使用这个被传递进来的函数，<br>最后改变了这个函数的返回结果。我们就叫这个函数为装饰器。</p>
<p>所以，我们刚刚举得例子中， func_1 就是装饰器。</p>
<h2 id="第二种-装饰器的最佳写法"><a href="#第二种-装饰器的最佳写法" class="headerlink" title="第二种 装饰器的最佳写法@"></a>第二种 装饰器的最佳写法@</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def func_1(func):</span><br><span class="line">    def func_2():</span><br><span class="line">        print(&apos;func_2&apos;)</span><br><span class="line">        func()</span><br><span class="line">    return func_2</span><br><span class="line"></span><br><span class="line">@func_1</span><br><span class="line">def say():</span><br><span class="line">    print(&apos;fxxk python&apos;)</span><br><span class="line"></span><br><span class="line">say()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>func_2<br>fxxk python</p>
</blockquote>
<p>输出结果一样，这两段代码的意思相同，只是写法不同，而其中 @func_1 就是语法糖的写法<br>通过 @ + 函数名称，就可以实现直接将 say 函数传递给 func_1,如此就是装饰器的最佳写法</p>
<h1 id="如何给装饰器传递参数"><a href="#如何给装饰器传递参数" class="headerlink" title="如何给装饰器传递参数"></a>如何给装饰器传递参数</h1><h2 id="不明确指定参数"><a href="#不明确指定参数" class="headerlink" title="不明确指定参数"></a>不明确指定参数</h2><p>通过 <em>args,*</em>kwargs  接收任意参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def func_1(func):</span><br><span class="line">    def func_2(*args, **kwargs):</span><br><span class="line">        print(&apos;func_2&apos;)</span><br><span class="line">        func(*args, **kwargs)</span><br><span class="line">    return func_2</span><br><span class="line"></span><br><span class="line">@func_1</span><br><span class="line">def say(something):</span><br><span class="line">    print(something)</span><br><span class="line"></span><br><span class="line">say(&apos;fxxk python&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>func_2<br>fxxk python</p>
</blockquote>
<h2 id="也可以明确指定参数"><a href="#也可以明确指定参数" class="headerlink" title="也可以明确指定参数"></a>也可以明确指定参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def func_1(func):</span><br><span class="line">    def func_2(ss):</span><br><span class="line">        print(&apos;func_2&apos;)</span><br><span class="line">        func(ss)</span><br><span class="line">    return func_2</span><br><span class="line"></span><br><span class="line">@func_1</span><br><span class="line">def say(something):</span><br><span class="line">    print(something)</span><br><span class="line"></span><br><span class="line">say(&apos;fxxk python&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>func_2<br>fxxk python</p>
</blockquote>
<h2 id="多个装饰器"><a href="#多个装饰器" class="headerlink" title="多个装饰器"></a>多个装饰器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">def func_1(func):</span><br><span class="line">    def func_inner(*args, **kwargs):</span><br><span class="line">        print(&apos;func_1&apos;)</span><br><span class="line">        func(*args, **kwargs)</span><br><span class="line">    return func_inner</span><br><span class="line"></span><br><span class="line">def func_2(func):</span><br><span class="line">    def func_inner(*args, **kwargs):</span><br><span class="line">        print(&apos;func_2&apos;)</span><br><span class="line">        func(*args, **kwargs)</span><br><span class="line">    return func_inner</span><br><span class="line"></span><br><span class="line">@func_1</span><br><span class="line">@func_2</span><br><span class="line">def say(something):</span><br><span class="line">    print(something)</span><br><span class="line"></span><br><span class="line">say(&apos;fxxk python&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>func_1<br>func_2<br>fxxk python</p>
</blockquote>
<p>以上就是装饰器的用法，<br>它可以将逻辑代码和业务分离开来，<br>降低代码的耦合度，提高代码的使用率。<br>比如记录一些代码的 log ，检查用户的合法性，都可以使用装饰器来高效使用。</p>
<h1 id="用户验证场景的装饰器使用"><a href="#用户验证场景的装饰器使用" class="headerlink" title="用户验证场景的装饰器使用"></a>用户验证场景的装饰器使用</h1><p>装饰器 user_check 实现用户合法性校验逻辑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def user_check(func):</span><br><span class="line">    def wrapper(username, password):</span><br><span class="line">        if (username != &apos;root&apos;):</span><br><span class="line">            raise Exception(&apos;permission denied&apos;)</span><br><span class="line">        elif (password != &apos;1234&apos;):</span><br><span class="line">            raise Exception(&apos;password incorrect&apos;)</span><br><span class="line">        else:</span><br><span class="line">            return func(username, password)</span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line">@user_check</span><br><span class="line">def login_user(username, password):</span><br><span class="line">    print(&apos;login success&apos;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user(&apos;name&apos;, &apos;1234&apos;)</span><br></pre></td></tr></table></figure>

<p>用户名不是 root ,抛出异常</p>
<blockquote>
<p>   raise Exception(‘permission denied’)<br>Exception: permission denied</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user(&apos;root&apos;, &apos;1111&apos;)</span><br></pre></td></tr></table></figure>

<p>密码不是 1234 ，抛出异常</p>
<blockquote>
<p> raise Exception(‘password incorrect’)<br>Exception: password incorrect</p>
</blockquote>
<p>用户合法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user(&apos;root&apos;, &apos;1234&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>login success!</p>
</blockquote>
<p>只要别的地方需要验证用户合法性，就直接去引用这个装饰器 user_check 就可以了</p>
<p>以上就是装饰器的用法，<br>它可以将逻辑代码和业务分离开来，<br>降低代码的耦合度，提高代码的使用率。<br>比如记录一些代码的 log ，检查用户的合法性，都可以使用装饰器来高效使用。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/12/python函数中参数的传递机制疑惑理解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/12/python函数中参数的传递机制疑惑理解/" itemprop="url">python函数中参数的传递机制疑惑理解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-12T14:53:57+08:00">
                2019-11-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/12/python函数中参数的传递机制疑惑理解/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/12/python函数中参数的传递机制疑惑理解/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>代码1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def foo(arg):</span><br><span class="line">    arg += 1</span><br><span class="line"></span><br><span class="line">a = 2</span><br><span class="line">foo(a)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2</p>
</blockquote>
<p>代码2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def foo(arg):</span><br><span class="line">    arg.append(6)</span><br><span class="line"></span><br><span class="line">a = [1, 2, 3]</span><br><span class="line">foo(a)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[1, 2, 3, 6]</p>
</blockquote>
<p>可以看出，<br>在执行完 foo 函数后<br>代码1 变量 a 值没有变化，还是 2<br>代码2 变量 a 值发生了变化，变为[1, 2, 3, 6]</p>
<p>为什么会这样呢？<br>还是重点<strong>Python中变量叫“名称”，赋值叫“贴标签”</strong></p>
<p>结合python中一切皆对象（object）的特点<br>a = 2, 实际是将整数对象 2 贴上了 a 这个标签<br>a = [1, 2, 3] ,实际是将列表对象 [1, 2, 3] 贴上了 a 这个标签</p>
<p>现在再来分析这两个代码<br>代码1：<br>一开始，a=2 将整数对象2贴上标签a<br>接着执行 foo 函数，将整数对象2贴上标签arg<br>此时标签a、arg均指向整数对象2<br>函数执行 arg += 1 后<br>arg标签指向整数对象 3<br>而 a 标签还是指向整数对象2<br>这时候再执行 print(a),当然输出为 2</p>
<p>代码2：<br>当 a = [1, 2, 3] 时，标签 a 指向列表对象[1, 2, 3]<br>把 a 传递给 foo 函数时，arg 标签同样指向列表对象[1, 2, 3]<br>执行 append(6) 时，标签 a 和 arg 同时指向列表对象[1, 2, 3, 6]<br>所以最后打印结果为 [1, 2, 3, 6]</p>
<p>原因分析：<br>整数型 和 列表 的数据类型不同，<br><strong>整数型对象是不可变类型，而列表是可变类型</strong><br><strong>当整数型 arg += 1 时，要保持原 a = 2 内存地址不变，系统会开辟一个新的空间来创造新的内存地址给引用arg</strong><br><strong>而列表对象在 append 时，列表天生就是可变的，所以不会创建新的内存地址</strong><br><strong>注意仅仅限于 append 方法， 如果用 += 方法也是会创建新的空间的</strong><br><strong>列表在使用 append方法进行改变时只是在当前做改变，所以代码中标签 a、arg 它们均指向了同一个内存地址</strong></p>
<p>总结<br>Python中的–赋值传递，它的关键之处在于数据类型是否可变<br>整数、元组、字符串是不可变的，所以它们作为参数进行函数操作时，会创建新的内存地址以供引用<br>列表、字典是可变的，作为参数进行函数操作时，不会创建新的地址</p>
<p>所以，当不可变类型变量希望通过函数进行“数据改变”时，<br>代码1可以如此这般，重新贴一次标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def foo(arg):</span><br><span class="line">    return arg + 1</span><br><span class="line"></span><br><span class="line">a = 2</span><br><span class="line">a = foo(a)  # 重新贴一次标签</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3</p>
</blockquote>
<p><strong>注意：可变类型进行 += 操作时候，也是会创建新的内存空间的</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def foo(arg):</span><br><span class="line">    return arg + [6]</span><br><span class="line"></span><br><span class="line">a = [1, 2, 3]</span><br><span class="line">foo(a)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[1, 2, 3]</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def foo(arg):</span><br><span class="line">    return arg + [6]</span><br><span class="line"></span><br><span class="line">a = [1, 2, 3]</span><br><span class="line">a = foo(a)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[1, 2, 3, 6]</p>
</blockquote>
<p>进一步结论，变量在进行函数操作后，值是否改变与这些有关<br>其一是：<br>变量类型是不是可变的<br>可变：列表、字典<br>不可变：整型、元组、字符串<br>其二是：<br>方法不同<br>+= 方法，不变，需要新开辟空间<br>append 方法，可变，不用新开空间，原基础上改变</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/08/如何更好地使用print/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/08/如何更好地使用print/" itemprop="url">如何更好地使用print</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-08T10:17:56+08:00">
                2019-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python入门/" itemprop="url" rel="index">
                    <span itemprop="name">Python入门</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/08/如何更好地使用print/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/08/如何更好地使用print/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>print默认是自动换行的<br>print的结尾默认加了一个换行转义字符 \n，所以会默认换行的</p>
<p>print()<br>print()</p>
<h1 id="print-使用-end-参数"><a href="#print-使用-end-参数" class="headerlink" title="print 使用 end 参数"></a>print 使用 end 参数</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(end=&apos;。&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;乾-大象&apos;)</span><br><span class="line">print(&apos;天行健&apos;, end=&apos;,&apos;)</span><br><span class="line">print(&apos;君子以自强不息&apos;, end=&apos;。&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>乾-大象<br>天行健,君子以自强不息。<br>Process finished with exit code 0</p>
</blockquote>
<h1 id="使用-sep"><a href="#使用-sep" class="headerlink" title="使用 sep"></a>使用 sep</h1><p>作用是将多个字符串 串起来打印，字符串之间加标点符号<br>不带 sep 默认是字符串之间加空格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;天行健&apos;, &apos;君子以自强不息&apos;)</span><br><span class="line">print(&apos;天行健&apos;, &apos;君子以自强不息&apos;, sep=&apos;,&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>天行健 君子以自强不息<br>天行健,君子以自强不息</p>
</blockquote>
<h1 id="巧用-format-和-f-string"><a href="#巧用-format-和-f-string" class="headerlink" title="巧用 format 和 f-string"></a>巧用 format 和 f-string</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;小明今年&apos; + str(18))</span><br><span class="line">print(&apos;小明今年&#123;&#125;&apos;.format(18))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>小明今年18<br>小明今年18</p>
</blockquote>
<p>或者这样<br>f-string 方式更灵活<br>直接在字符串中添加{}，在{}中添加变量或函数都可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age = 18</span><br><span class="line">print(f&apos;小明今年&#123;age&#125;&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>小明今年18</p>
</blockquote>
<p>在{}中添加函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def test():</span><br><span class="line">    return 17</span><br><span class="line"></span><br><span class="line">print(f&apos;小明今年&#123;test()&#125;&apos;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>小明今年17</p>
</blockquote>
<h1 id="print-的另一种格式化"><a href="#print-的另一种格式化" class="headerlink" title="print 的另一种格式化 %"></a>print 的另一种格式化 %</h1><p>最常用的点位符是 %s 和 %d<br>注意 % 前后不加逗号,<br>用元组小括号()将要打印的数据包裹起来即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;%s今年%d,长度是%d&apos; % (&apos;小明&apos;, 18, 18))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>小明今年18,长度是18</p>
</blockquote>
<h1 id="print-还可以打印各种类型"><a href="#print-还可以打印各种类型" class="headerlink" title="print 还可以打印各种类型"></a>print 还可以打印各种类型</h1><h2 id="列表、元组、变量都不在话下"><a href="#列表、元组、变量都不在话下" class="headerlink" title="列表、元组、变量都不在话下"></a>列表、元组、变量都不在话下</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">list = [1, 2, 3, 4, 5, 6]</span><br><span class="line">tuple = (1, 2, 3, 4, 5, 6)</span><br><span class="line">num = 999</span><br><span class="line">print(list)</span><br><span class="line">print(tuple)</span><br><span class="line">print(num)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[1, 2, 3, 4, 5, 6]<br>(1, 2, 3, 4, 5, 6)<br>999</p>
</blockquote>
<h2 id="打印类实例"><a href="#打印类实例" class="headerlink" title="打印类实例"></a>打印类实例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class Person():</span><br><span class="line">    def __init__(self, name, length):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.length = length</span><br><span class="line"></span><br><span class="line">print(Person(&apos;小明&apos;, 18))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&lt;<strong>main</strong>.Person object at 0x0119DDF0&gt;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Person():</span><br><span class="line">    def __init__(self, name, length):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.length = length</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        return f&apos;Person的信息是 name:&#123;self.name&#125; length:&#123;self.length&#125;&apos;</span><br><span class="line"></span><br><span class="line">print(Person(&apos;小明&apos;, 18))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Person的信息是 name:小明 length:18</p>
</blockquote>
<p>以上代码先在类中定义了 <strong>str</strong> 方法，这样在执行 print 的时候<br>它会先去执行 str 方法，从而打印出相关信息</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/07/如何理解Python中的闭包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LST">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding Python">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/07/如何理解Python中的闭包/" itemprop="url">如何理解Python中的闭包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-07T10:49:45+08:00">
                2019-11-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Python进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/07/如何理解Python中的闭包/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/07/如何理解Python中的闭包/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="闭包的理解基础"><a href="#闭包的理解基础" class="headerlink" title="闭包的理解基础"></a>闭包的理解基础</h1><p>闭包解决的是函数嵌套的变量访问问题</p>
<h2 id="非闭包场景"><a href="#非闭包场景" class="headerlink" title="非闭包场景"></a>非闭包场景</h2><p>内部函数 inner_fun 可以成功访问外部变量 x</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def outer_fun(x):</span><br><span class="line">    def inner_fun():</span><br><span class="line">        print(x)</span><br><span class="line">    inner_fun()</span><br><span class="line"></span><br><span class="line">outer_fun(6)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>6</p>
</blockquote>
<p>如果在内部函数 inner_fun 要修改变量 x 的值，就行不通了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def outer_fun(x):</span><br><span class="line">    def inner_fun():</span><br><span class="line">        x += 1</span><br><span class="line">        print(x)</span><br><span class="line">    inner_fun()</span><br><span class="line"></span><br><span class="line">outer_fun(6)</span><br></pre></td></tr></table></figure>

<blockquote>
<p> x += 1<br>UnboundLocalError: local variable ‘x’ referenced before assignment</p>
</blockquote>
<p>这时想修改必须 在内部函数 inner_fun 中声明 nonlocal 变量才行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def outer_fun(x):</span><br><span class="line">    def inner_fun():</span><br><span class="line">        nonlocal x</span><br><span class="line">        x += 1</span><br><span class="line">        print(x)</span><br><span class="line">    inner_fun()</span><br><span class="line"></span><br><span class="line">outer_fun(6)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>7</p>
</blockquote>
<h2 id="闭包场景"><a href="#闭包场景" class="headerlink" title="闭包场景"></a>闭包场景</h2><p>闭包举例<br>这里将外部函数 outer_fun 的返回，return 为这个嵌套函数 inner_fun<br>outer_fun(6) 调用了第一次后，x + 1 = 7<br>再次调用 outer() 时，记住了这个变量 7</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def outer_fun(x):</span><br><span class="line">    def inner_fun():</span><br><span class="line">        print(x + 1)</span><br><span class="line">    return inner_fun</span><br><span class="line"></span><br><span class="line">outer = outer_fun(6)</span><br><span class="line">outer()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>7</p>
</blockquote>
<p>注意看 outer = outer_fun(6) 这一行代码，是不是跟类的实例化非常相似呢？<br>这就是闭包，可以将一些变量数据直接附加到“闭包”里面，<br>此时这个“闭包”会记住这些变量数据。<br>好比面向对象的封装一样，把一些属性和变量封装到一个对象类里面</p>
<h2 id="怎么创建一个闭包"><a href="#怎么创建一个闭包" class="headerlink" title="怎么创建一个闭包"></a>怎么创建一个闭包</h2><p>首先它得是一个<strong>嵌套函数</strong><br>接着<strong>内部函数引用nonlocal变量</strong><br>最后嵌套函数的<strong>返回是内部函数</strong></p>
<h2 id="闭包具体应用简单举例"><a href="#闭包具体应用简单举例" class="headerlink" title="闭包具体应用简单举例"></a>闭包具体应用简单举例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def outer_fun(x):</span><br><span class="line">    def inner_fun(y):</span><br><span class="line">        print(x + y)</span><br><span class="line">    return inner_fun</span><br><span class="line"></span><br><span class="line">outer = outer_fun(5)</span><br><span class="line">outer()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>TypeError: inner_fun() missing 1 required positional argument: ‘y’</p>
</blockquote>
<p>这里会报错，因为内部函数 inner_fun 也要传入一个参数 y</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def outer_fun(x):</span><br><span class="line">    def inner_fun(y):</span><br><span class="line">        print(x + y)</span><br><span class="line">    return inner_fun</span><br><span class="line"></span><br><span class="line">outer = outer_fun(5)</span><br><span class="line">outer(1)</span><br><span class="line">outer(6)</span><br><span class="line">outer(60)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>6<br>11<br>65</p>
</blockquote>
<p>outer = outer_fun(5) 引用记住了参数 5<br>outer(1) outer(6) outer(60) 依次执行 + y 的操作</p>
<p>可以看到，当我们使用闭包的时候，<br>我们不需要定义全局变量，也可以访问到函数内部的数据<br>（一般情况下函数外部是没有办法访问函数内部的变量数据的），<br>也就是说可以拿到闭包提供的隐藏数据。</p>
<p>注意看 outer = outer_fun(5) 这一行代码，是不是跟类的实例化非常相似呢？<br>这样的话，如果我们的某个功能只需要一个函数的话，那么我们就直接写一个闭包，而不用写一个类那么麻烦。</p>
<p>我想，往后我跟你说装饰器的时候，你会更加明白闭包的应用。</p>
<p>总之，Python 中的闭包就像一个包，<br>这个包的牛逼之处在于，<br>它可以让我们引用函数中的 nonlocal 变量，<br>这个包可以隐藏一些变量数据，当我们需要的时候，就可以从这个包获取。</p>
<p><strong>当你发现你要写的类只需要一个方法就能实现的时候，用闭包是一种更好的选择。</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">LST</p>
              <p class="site-description motion-element" itemprop="description">Python编程学习, 程序化思维提升, 总结</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">43</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">222</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LST</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'NHCq9IhbmKjGr6qmlDUWBzG7-gzGzoHsz',
        appKey: 'lCJYjyt1KpWy3jVat6su83fl',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  

  
  

  

  

  

</body>
</html>
